package com.fileReader.fileReadService;

import java.io.FileWriter;
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;

import org.apache.pdfbox.pdmodel.PDDocument;
import org.apache.pdfbox.text.PDFTextStripper;
import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.ss.usermodel.Sheet;
import org.apache.poi.ss.usermodel.Workbook;
import org.apache.poi.ss.usermodel.WorkbookFactory;
import org.springframework.stereotype.Service;
import org.springframework.web.multipart.MultipartFile;

import com.aspose.pdf.Document;

@Service
public class FileReadService {

	public List<String> readExcelData(MultipartFile eFile) throws IOException {
		List<String> emailDataList = new ArrayList<>();

		try (Workbook workbook = WorkbookFactory.create(eFile.getInputStream())) {
			Sheet sheet = workbook.getSheetAt(0); // Assuming data is in the first sheet

			// Iterate over each row
			for (int i = 0; i <= sheet.getLastRowNum(); i++) {
				Row row = sheet.getRow(i);
				if (row != null) {
					StringBuilder rowData = new StringBuilder();

					// Iterate over each cell in the row
					for (int j = 0; j < row.getLastCellNum(); j++) {
						Cell cell = row.getCell(j);
						if (cell != null) {
							// Append cell value to rowData
							rowData.append(cell.toString()).append("  ");
						}
					}
					// Add rowData to emailDataList
					emailDataList.add(rowData.toString());
				}
			}
		}
		return emailDataList;
	}
         
	public String readTableFromPdf(MultipartFile file) throws IOException
	{
		
		
		Document doc=new Document(file.getInputStream());
		
		for (int page = 1; page <=doc.getPages().size(); page++) {
			 
			
			doc.getPages().get_Item(page);
			
		}
		
		
		
		return null;
	}
}
